<!DOCTYPE html>
<html lang="zh-CN" class="no-js">
<head>
    <meta charset="UTF-8">
    <base href='http://yisonli.github.io/'>
    <meta name="baidu-site-verification" content="73P8XwbEjJ" />
    <!--<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />-->
    <title></title>
    <style>
      body{
        margin:0;
        padding:0;
        background: #DADEE2;
      }
      img{
           margin: 20px auto;
           display: block;
           max-width: 100%;
      }
      .globalWidth{
        display: block;
        width:1160px;
        margin: 0 auto;
        /*border:2px white solid;*/
        text-align: left;
      }
      div.header{
        padding: 20px 0 5px;
        background:#144254;
      }
      div.header .inner{
        color: #EBEDEF;
      }
      div.header .inner .title{
        font-size: 46px;
      }
      div.header .inner a,
      div.header .inner a:visited{
        font-weight: bold;
        color: #EBEDEF;
        text-decoration: none;
      }
      div.header .inner a:hover{
        color: #0000EF;
      }
      div.header .inner small{
        font-size: 18px;
        /*margin-left: 20px;*/
      }
      .article{
        margin: 16px 0;
      }
      .article .leftPart{
        width:1100px;
        /*border:1px solid;*/
        float: left;
      }
      .article .leftPart .format_left{
        padding: 16px;
        margin: 0 0 16px 0;
        background: #FFFFFF;
      }
      .article .rightPart{
        width:45px;
        height:45px;
        border:1px solid #ABADAF;
        float: right;
        /*background: #D8DBDE;*/
        background: #ABADAF;
      }
      .article .rightPart .format_right{
        /*padding: 14px;*/
      }
      
      .color_title{color: #444444;}
      .color_content{color: #8F446C;}
      .color_tag{color: #CDBBC4;}
      
      .iTitle{
        font-size: 30px;
        font-family: "微软雅黑";
        color: #444444;
      }
      .iTitle a,.iTitle a:visited{
        color: #444444;
        text-decoration: none;
      }
      .iTitle a:hover{
        color:#999999;
      }
      .iInfoMore{
        padding: 10px 0;
        font-size: 14px;
      }
      .iContent{
        padding: 20px 0;
        font:15px/20px "";
      }
      
    </style>
    <script>
            </script>
  </head>
  <body>
    <!--START OF 头部-->
    <div class="header">
      <div class="inner globalWidth">
        <div class="title"><a href="http://yisonli.github.io/">Yisonの小站</a></div>
        <small><a href="http://yisonli.github.io/">其实，有一种风景无需刻意寻觅就能随时随地感受到</a></small>
      </div>
    </div>
    <!--END OF 头部-->
    <!--START OF 内容-->
    <div class="article">
      <div class="globalWidth">
        <div class="leftPart">
                    <div class="format_left">
            <div class="iTitle"><a href="article/48.html">如何使用ECS+COS</a></div>
            <div class="iInfoMore">
                <b>日期</b>
                <span class="iDate">2017-05-03</span>
                <b>分类</b>
                <span class="iTag">Linux</span>
                <b>标签</b>
                                <span class="iTag">#Linux#</span>
                            </div>
            <div class="iContent"><p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">COS是腾讯云的一项服务，免费50G存储空间，按外网流量使用情况收费，内网调用免流量。</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">本文主要讲如何能享受到COS的内网流量，前提当然是你已经有一个ECS服务器了。</p><p></p><p>&nbsp;</span></p><h2 style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">一、COS开通&amp;配置</span></h2><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">1、开通对象存储服务，比较简单，根据提示开通即可</span></p><p style="text-align:center"><img src="http://blog.yyeer.com/static/wp-content/uploads/2017/05/open_cos.jpg" alt="" width="372" height="216"/></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2、创建Bucket，注意所属地域要与服务器的一致，否则不算内网</span></p><p style="text-align:center"><img src="http://blog.yyeer.com/static/wp-content/uploads/2017/05/open_bucket.jpg" alt="" width="510" height="567"/></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">3、获取秘钥配置</span></p><p style="text-align:center"><img src="http://blog.yyeer.com/static/wp-content/uploads/2017/05/cos_secret.jpg" alt="" width="899" height="298"/></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;<br style="text-align: left;"/></span></p><h2 style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">二、选用wp的COS插件，上传图片时可以同步到COS上</span></h2><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;本文采用来自&nbsp;水冷眸&nbsp;的cos-sync，插件地址于&nbsp;</span><a href="https://www.slmwp.com/cos-sync-plugins.html" style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; text-decoration: underline;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">https://www.slmwp.com/cos-sync-plugins.html</span></a><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;，大家可以去下载后直接解压即可，秘钥配置在此插件上会用得上。&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;当然这个插件存在一些问题，我也稍作修改了一点东西，但由于改动不大且最终效果不好，就不将修改的版本贴出。</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;至此已经可以使用cos，并且能访问cos的资源；但是此时还不能达到内网流量的目的，如果cos没有使用cdn加速，则流量会耗得很快。</p><p></p><p>&nbsp;</span></p><h2 style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">三、如何享受COS内网流量</span></h2><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">方法A.&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;自己实现一个在服务器上读取cos图片的服务，读取完后再返回图片内容；如此页面上直接用img标签即可显示。&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;评价：实现倒不复杂，只是会遇到点问题，cos上的keep-alive值得注意，设超时时间可解决但不完美。</p><p></p><p>&nbsp;&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;示例：<br style="text-align: left;"/></span></p><pre class="brush:php;toolbar:false;">&lt;?php</p><p>&nbsp;</p><p>if(empty($_GET[&quot;file&quot;]))&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(&#39;no&nbsp;access&#39;);</p><p>}</p><p>&nbsp;</p><p>require(&nbsp;dirname(&nbsp;__FILE__&nbsp;)&nbsp;.&nbsp;&#39;/../../../wp-blog-header.php&#39;&nbsp;);</p><p>require_once(&#39;sdk/include.php&#39;);</p><p>use&nbsp;Qcloudcos\Auth;</p><p>use&nbsp;Qcloudcos\Cosapi;</p><p>&nbsp;</p><p>Cosapi::setTimeout(180);</p><p>//&nbsp;设置COS所在的区域：</p><p>$cos_opt&nbsp;=&nbsp;get_option(&#39;cos_options&#39;,&nbsp;TRUE);</p><p>$regional&nbsp;=&nbsp;esc_attr($cos_opt[&#39;regional&#39;]);</p><p>Cosapi::setRegion($regional);</p><p>&nbsp;</p><p>&nbsp;</p><p>//去COS读取文件咯</p><p>$file&nbsp;=&nbsp;$_GET[&quot;file&quot;];</p><p>$extention&nbsp;=&nbsp;pathinfo($file,&nbsp;PATHINFO_EXTENSION);</p><p>function&nbsp;getContentType($extention){</p><p>&nbsp;&nbsp;&nbsp;&nbsp;switch&nbsp;($extention)&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;tif&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;tiff&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;image/tiff&#39;;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;fax&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;image/fax&#39;;&nbsp;break;</p><p>case&nbsp;&#39;gif&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;image/gif&#39;;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;ico&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;image/x-icon&#39;;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;jpe&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;jpeg&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;jpg&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;jfif&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;image/jpeg&#39;;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;net&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;image/pnetvue&#39;;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;png&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;image/png&#39;;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;rp&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;image/vnd.rn-realpix&#39;;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;wbmp&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;image/vnd.wap.wbmp&#39;;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;&#39;bmp&#39;:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&#39;application/x-bmp&#39;;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;default:</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die(&#39;not&nbsp;support&nbsp;type.&#39;);</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;}</p><p>}</p><p>$content_type&nbsp;=&nbsp;getContentType($extention);</p><p>&nbsp;</p><p>//获取WP配置信息</p><p>$cos_options&nbsp;=&nbsp;get_option(&#39;cos_options&#39;,&nbsp;TRUE);</p><p>$cos_bucket&nbsp;=&nbsp;esc_attr($cos_options[&#39;bucket&#39;]);</p><p>try&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;$ret&nbsp;=&nbsp;Cosapi::stat($cos_bucket,&nbsp;$file);</p><p>}&nbsp;catch&nbsp;(Exception&nbsp;$ex)&nbsp;{</p><p>&nbsp;&nbsp;&nbsp;&nbsp;var_dump($ex);</p><p>}</p><p>&nbsp;</p><p>if(!empty($ret[&#39;data&#39;][&#39;source_url&#39;]))&nbsp;{</p><p>$opts&nbsp;=&nbsp;array(</p><p>&#39;http&#39;=&gt;array(</p><p>//&#39;protocol_version&#39;=&gt;1.0,</p><p>&#39;method&#39;=&gt;&quot;GET&quot;,</p><p>&#39;timeout&#39;=&gt;1,</p><p>)</p><p>);</p><p>$context&nbsp;=&nbsp;stream_context_create($opts);</p><p>$fileres&nbsp;=&nbsp;file_get_contents($ret[&#39;data&#39;][&#39;source_url&#39;],false,$context);</p><p>&nbsp;</p><p>header(&#39;Content-type:&nbsp;&#39;.$content_type);</p><p>echo&nbsp;$fileres;</p><p>}</p><p>die(&#39;no&nbsp;file&#39;);</pre><p style="text-align: left;"><br style="text-align: left;"/></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">方法B.&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;用nginx对cos做一层代理，对外域名是服务器的地址，实际上是服务器读取cos后返回的结果。&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;评价：实现简单，响应及时。&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp;&nbsp;&nbsp;&nbsp;实现：&nbsp;</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">&nbsp; &nbsp;&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 10px;"></span></span></p><pre class="brush:bash;toolbar:false;">location&nbsp;^~&nbsp;/static/&nbsp;{&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rewrite&nbsp;^/static/(.*)&nbsp;/$1&nbsp;break;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_pass&nbsp;http://你的COS域名.myqcloud.com/;&nbsp;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;}</pre><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;; font-size: 10px;">&nbsp; &nbsp;&nbsp;</span><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">访问：&nbsp;&nbsp;&nbsp;http://你的博客域名/static/存储路径 &nbsp;&nbsp;</span></p><h2 style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">四、cos-sync插件的建议不勾选？</span></h2><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">问：能否不在本地保存，能否不上传缩略图？&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">答：可以，但会有一些问题（本人尝试改了一些后，功能基本不受影响，但体验差了些）。</p><p></p><p>&nbsp;&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"><br style="text-align: left;"/></span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">问题A.</p><p></p><p>不勾选后，媒体库的缩略图出不来。</span></p><p style="text-align:center"><img src="http://blog.yyeer.com/static/wp-content/uploads/2017/05/cos-sync-problem1.jpg" alt="" width="307" height="236"/></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">原因：服务器不存储，无法得知图片size，导致默认成了1的宽高&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">解决：</p><p></p><p>1.wp-includes/media.php&nbsp;莫约444行改为如下</span></p><pre class="brush:php;toolbar:false;">//&nbsp;Very&nbsp;small&nbsp;dimensions&nbsp;may&nbsp;result&nbsp;in&nbsp;0,&nbsp;1&nbsp;should&nbsp;be&nbsp;the&nbsp;minimum.</p><p>$w&nbsp;=&nbsp;max&nbsp;(&nbsp;150,&nbsp;(int)&nbsp;round(&nbsp;$current_width&nbsp;&nbsp;*&nbsp;$ratio&nbsp;)&nbsp;);</p><p>$h&nbsp;=&nbsp;max&nbsp;(&nbsp;150,&nbsp;(int)&nbsp;round(&nbsp;$current_height&nbsp;*&nbsp;$ratio&nbsp;)&nbsp;);</pre><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2.wp-admin/includes/image-edit.php&nbsp;莫约606行改为如下&nbsp;</span></p><pre class="brush:php;toolbar:false;">$w2&nbsp;=&nbsp;max&nbsp;(&nbsp;150,&nbsp;$w&nbsp;*&nbsp;$ratio&nbsp;);</p><p>$h2&nbsp;=&nbsp;max&nbsp;(&nbsp;150,&nbsp;$h&nbsp;*&nbsp;$ratio&nbsp;);</pre><p style="text-align: left;"><br style="text-align: left;"/></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">问题B.</p><p></p><p>写文章或页面时，插入媒体库的图片后，预览看不到图片。&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">原因：服务器不存储，无法得知图片size，导致默认成了1的宽高&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">解决：</p><p></p><p>1.修改wp-includes/media_template.php&nbsp;莫约680行：&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:php;toolbar:false;">&lt;#&nbsp;if&nbsp;(&nbsp;&#39;undefined&#39;&nbsp;!==&nbsp;typeof&nbsp;data.sizes&nbsp;)&nbsp;{&nbsp;#&gt;</p><p>&lt;label&nbsp;class=&quot;setting&quot;&gt;</p><p>&lt;span&gt;&lt;?php&nbsp;_e(&#39;Size&#39;);&nbsp;?&gt;&lt;/span&gt;</p><p>&lt;select&nbsp;class=&quot;size&quot;&nbsp;name=&quot;size&quot;</p><p>data-setting=&quot;size&quot;</p><p>&lt;#&nbsp;if&nbsp;(&nbsp;data.userSettings&nbsp;)&nbsp;{&nbsp;#&gt;</p><p>data-user-setting=&quot;imgsize&quot;</p><p>&lt;#&nbsp;}&nbsp;#&gt;&gt;</p><p>&lt;?php</p><p>/**&nbsp;This&nbsp;filter&nbsp;is&nbsp;documented&nbsp;in&nbsp;wp-admin/includes/media.php&nbsp;*/</p><p>$sizes&nbsp;=&nbsp;apply_filters(&nbsp;&#39;image_size_names_choose&#39;,&nbsp;array(</p><p>&#39;thumbnail&#39;&nbsp;=&gt;&nbsp;__(&#39;Thumbnail&#39;),</p><p>&#39;medium&#39;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;__(&#39;Medium&#39;),</p><p>&#39;large&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;__(&#39;Large&#39;),</p><p>&#39;full&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;__(&#39;Full&nbsp;Size&#39;),</p><p>)&nbsp;);</p><p>&nbsp;</p><p>foreach&nbsp;(&nbsp;$sizes&nbsp;as&nbsp;$value&nbsp;=&gt;&nbsp;$name&nbsp;)&nbsp;:&nbsp;?&gt;</p><p>&lt;#</p><p>var&nbsp;size&nbsp;=&nbsp;data.sizes[&#39;&lt;?php&nbsp;echo&nbsp;esc_js(&nbsp;$value&nbsp;);&nbsp;?&gt;&#39;];</p><p>if&nbsp;(&nbsp;size&nbsp;)&nbsp;{&nbsp;#&gt;</p><p>&lt;option&nbsp;value=&quot;&lt;?php&nbsp;echo&nbsp;esc_attr(&nbsp;$value&nbsp;);&nbsp;?&gt;&quot;&nbsp;&lt;?php&nbsp;selected(&nbsp;$value,&nbsp;&#39;full&#39;&nbsp;);&nbsp;?&gt;&gt;</p><p>&lt;?php&nbsp;echo&nbsp;esc_html(&nbsp;$name&nbsp;);&nbsp;?&gt;&nbsp;–&nbsp;{{&nbsp;size.width&nbsp;}}&nbsp;×&nbsp;{{&nbsp;size.height&nbsp;}}</p><p>&lt;/option&gt;</p><p>&lt;#&nbsp;}&nbsp;#&gt;</p><p>&lt;?php&nbsp;endforeach;&nbsp;?&gt;</p><p>&lt;/select&gt;</p><p>&lt;/label&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;#&nbsp;}&nbsp;else&nbsp;{&nbsp;#&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;setting&quot;&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;name=&quot;size&quot;&nbsp;value=&quot;full&quot;&nbsp;/&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/label&gt;</p><p>&lt;#&nbsp;}&nbsp;#&gt;</pre><p><span style=";font-family:宋体;color:rgb(255,0,0);font-size:14px"></span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;">2.莫约931行开始：&nbsp;</span></p><p style="text-align: left;"><span style="font-family: 微软雅黑, &#39;Microsoft YaHei&#39;;"></span></p><pre class="brush:php;toolbar:false;">&lt;#&nbsp;if&nbsp;(&nbsp;&#39;undefined&#39;&nbsp;!==&nbsp;typeof&nbsp;data.attachment.sizes&nbsp;)&nbsp;{&nbsp;#&gt;</p><p>&lt;label&nbsp;class=&quot;setting&nbsp;size&quot;&gt;</p><p>&lt;span&gt;&lt;?php&nbsp;_e(&#39;Size&#39;);&nbsp;?&gt;&lt;/span&gt;</p><p>&lt;select&nbsp;class=&quot;size&quot;&nbsp;name=&quot;size&quot;</p><p>data-setting=&quot;size&quot;</p><p>&lt;#&nbsp;if&nbsp;(&nbsp;data.userSettings&nbsp;)&nbsp;{&nbsp;#&gt;</p><p>data-user-setting=&quot;imgsize&quot;</p><p>&lt;#&nbsp;}&nbsp;#&gt;&gt;</p><p>&lt;?php</p><p>/**&nbsp;This&nbsp;filter&nbsp;is&nbsp;documented&nbsp;in&nbsp;wp-admin/includes/media.php&nbsp;*/</p><p>$sizes&nbsp;=&nbsp;apply_filters(&nbsp;&#39;image_size_names_choose&#39;,&nbsp;array(</p><p>&#39;thumbnail&#39;&nbsp;=&gt;&nbsp;__(&#39;Thumbnail&#39;),</p><p>&#39;medium&#39;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;__(&#39;Medium&#39;),</p><p>&#39;large&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;__(&#39;Large&#39;),</p><p>&#39;full&#39;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&gt;&nbsp;__(&#39;Full&nbsp;Size&#39;),</p><p>)&nbsp;);</p><p>&nbsp;</p><p>foreach&nbsp;(&nbsp;$sizes&nbsp;as&nbsp;$value&nbsp;=&gt;&nbsp;$name&nbsp;)&nbsp;:&nbsp;?&gt;</p><p>&lt;#</p><p>var&nbsp;size&nbsp;=&nbsp;data.sizes[&#39;&lt;?php&nbsp;echo&nbsp;esc_js(&nbsp;$value&nbsp;);&nbsp;?&gt;&#39;];</p><p>if&nbsp;(&nbsp;size&nbsp;)&nbsp;{&nbsp;#&gt;</p><p>&lt;option&nbsp;value=&quot;&lt;?php&nbsp;echo&nbsp;esc_attr(&nbsp;$value&nbsp;);&nbsp;?&gt;&quot;&gt;</p><p>&lt;?php&nbsp;echo&nbsp;esc_html(&nbsp;$name&nbsp;);&nbsp;?&gt;&nbsp;–&nbsp;{{&nbsp;size.width&nbsp;}}&nbsp;×&nbsp;{{&nbsp;size.height&nbsp;}}</p><p>&lt;/option&gt;</p><p>&lt;#&nbsp;}&nbsp;#&gt;</p><p>&lt;?php&nbsp;endforeach;&nbsp;?&gt;</p><p>&lt;option&nbsp;value=&quot;&lt;?php&nbsp;echo&nbsp;esc_attr(&nbsp;&#39;custom&#39;&nbsp;);&nbsp;?&gt;&quot;&gt;</p><p>&lt;?php&nbsp;_e(&nbsp;&#39;Custom&nbsp;Size&#39;&nbsp;);&nbsp;?&gt;</p><p>&lt;/option&gt;</p><p>&lt;/select&gt;</p><p>&lt;/label&gt;</p><p>&lt;#&nbsp;}&nbsp;else&nbsp;{&nbsp;#&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;label&nbsp;class=&quot;setting&nbsp;size&quot;&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;input&nbsp;type=&quot;hidden&quot;&nbsp;name=&quot;size&quot;&nbsp;value=&quot;full&quot;&nbsp;/&gt;</p><p>&lt;/label&gt;</p><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;#&nbsp;}&nbsp;#&gt;</pre><p><span style=";font-family:宋体;color:rgb(255,0,0);font-size:14px"></span></p></p></div>
          </div>
                  </div>
        <div class="rightPart">
          <div class="format_right">
            <a href="http://yisonli.github.io/rss2.xml">RSS</a>          </div>
        </div>
      </div>
      
    </div>
    <!--END OF 内容-->
    <!--START OF 脚部-->
    <!--END OF 脚部-->

  </body>
  
</html>
<script>
var data = {};

</script>